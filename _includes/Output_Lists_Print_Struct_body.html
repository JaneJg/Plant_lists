<script>

var item = localStorage.getItem('Item');
var title = localStorage.getItem('Title');
var Header = localStorage.getItem('headr');
$(document).ready(function(){
dummy1.insertAdjacentHTML( 'beforeend',"\t<h2>List of Species for <b>" + title + "</h2>");
dummy.insertAdjacentHTML( 'beforeend', Header);
let species;
$.getJSON('Data/Lists.json', function(results){
  records = results.filter(function(obj) {
  return obj.AREA === item;
  }); // end filter

$.getJSON('Data/Names.json', function(names){

   let filterIds = new Set(records.map(item => item.CODE));
   species = names.filter(item => filterIds.has(item.CODE));

    var Species_List = document.getElementById("Species_List");
Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Gymnosperms</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");

 var filtered_species = species.filter(item => item.PHYS == 'A');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach

Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Trees and Shrubs </H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");

 var filtered_species = species.filter(item => item.PHYS == 'C');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach

Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Woody Climbers</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");

 var filtered_species = species.filter(item => item.PHYS == 'E');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach

Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Lycopods and horsetails</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");

 var filtered_species = species.filter(item => item.PHYS == 'F');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach

Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Ferns</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");

 var filtered_species = species.filter(item => item.PHYS == 'H');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach

Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Grasses</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");


 var filtered_species = species.filter(item => item.PHYS == 'I');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach
Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Sedges</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");


 var filtered_species = species.filter(item => item.PHYS == 'J');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach
Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Rushes and allied plants</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");


 var filtered_species = species.filter(item => item.PHYS == 'K');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach

Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Daisy-like herbs</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");


 var filtered_species = species.filter(item => item.PHYS == 'M');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach
Species_List.insertAdjacentHTML( 'beforeend',"<tr><TD> </TD></TR><TR><TD> </TD><TD> <H4>Other herbs</H4>  </TD><TD>  </TD></TR><tr></TR><tr></TR>");

 var filtered_species = species.filter(item => item.PHYS == 'N');
     filtered_species.forEach(function(ids) {

Species_List.insertAdjacentHTML( 'beforeend',"<TR><TD>" + ids.E + "</TD><TD><i>" + ids.NAME + " " +  ids.NOTES + "</i></TD><TD>" + ids.C_NAME + "</TD></TR>");
      }); // end of forEach


    }) // end of second Ajax call
  }) // end of which?? Ajax call
 }) // end of $(document).ready() function

</script>

<Table id="dummy">
<div id="dummy1"><div>
<tr VALIGN="TOP"><TD WIDTH=40%></TD><TD WIDTH=30%></TD><TD WIDTH=40%></TD><TD WIDTH=40%></TD></tr>
</Table>

 <hr style="height:2px;border-width:0;color:gray;background-color:gray">
    <Table id="Species_List">
<tr VALIGN="TOP"><TD WIDTH=2%></TD><TD WIDTH=60%></TD><TD WIDTH=35%></TD><TD WIDTH= 3%></TD></tr>
<TR><TD> Adv  </TD><TD> <b>Name</b> </TD><TD> <b>Common_NAME</b> </TD></TR>



